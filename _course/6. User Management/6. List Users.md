## List Users

add route + component

```tsx
<ion-route url='/users' component='page-user-list' />
```

Add list component - just to display data

```tsx
import { Component, Prop } from '@stencil/core';

@Component({
	tag: 'user-list',
	styleUrl: 'user-list.scss'
})
export class UserList {
	@Prop() header: string;
	@Prop() users: User[];

	render() {
		return (
			<ion-list>
				<ion-list-header>{this.header}</ion-list-header>
				{this.users
					? this.users.map(user => (
							<ion-item>
								<ion-avatar>
									<img src={user.photoURL} alt={user.displayName} />
								</ion-avatar>
								<ion-label>
									<h2>{user.displayName}</h2>
									<p>{user.role}</p>
								</ion-label>
							</ion-item>
					  ))
					: undefined}
			</ion-list>
		);
	}
}
```

style avatar

```scss
user-list {
	ion-avatar {
		margin-right: 16px;
	}
}
```

Create a user service

```ts
export class UserService {}
export const userSvc = new UserService();
```

getUsers fn

```tsx
import { collection, collectionData } from 'rxfire/firestore';
import { firestore } from '../firebase';
import { tap, map } from 'rxjs/operators';

	async getWithSDK() {
		const usersRef = firestore.collection('users');
		const usersCol = await usersRef.get();
		console.log('QueryDocumentSnapshot[] fromSDK: ', usersCol.docs);
		return usersCol.docs.map(d => {
			const id = d.id;
			const data = d.data();
			return { id, ...data };
		});
	}
	getcollection() {
		return collection(firestore.collection('users')).pipe(
			tap(data => console.log('QueryDocumentSnapshot[] fromCollection: ', data)),
			// we can map it to only needed data
			map(docs =>
				docs.map(d => {
					const id = d.id;
					const data = d.data();
					return { id, ...data };
				})
			)
			// tap(data => console.log('fromCollection: ', data))
		);
	}

	getcollectionData() {
		// just like the above after mapping, only the data and id
		return collectionData<User>(firestore.collection('users'), 'id').pipe(
			tap(data => console.log('fromCollectionData: ', data))
		);
	}

```

on component

```tsx
import { userSvc } from '../../services/user.service';

export class PageUserList {
	@State() users: firebase.firestore.DocumentData[];

	componentWillLoad() {
		this.getUsersWithSDK();
		userSvc.getcollection().subscribe(data => (this.users = data));
		userSvc.getcollectionData().subscribe(data => (this.users = data));
	}

	async getUsersWithSDK() {
		this.users = await userSvc.getWithSDK();
		console.log('fromSDK: ', this.users);
	}

	render() {
		return [
			<Navbar title='Home' />,
			<ion-content>
				<user-list header='User List' users={this.users} />
			</ion-content>
		];
	}
}
```

try list rules for non authed users (use incognito)
