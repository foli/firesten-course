## Create User Account (Cloud function)

First lets initialize the admin sdk in our functions folder

```ts
import * as functions from 'firebase-functions';
import * as admin from 'firebase-admin';

admin.initializeApp(functions.config().firebase);
```

To keep it organize lets create a new file for our user stuff: `functions/src/user.ts`

Imports

```ts
import * as functions from 'firebase-functions';
import * as admin from 'firebase-admin';

const db = admin.firestore();
```

Create user account fn

```ts

export const createUserAccount = functions.auth.user().onCreate(e => {
	console.log('Event: ', e);

	const user = {
		email: e.email,
		displayName: e.displayName,
		memberSince: e.metadata.creationTime, // add it to the user interface
		phoneNumber: e.phoneNumber,
		photoURL: e.photoURL,
		uid: e.uid,
		role: ['user']
	};
	const userRef = db.doc(`/users/${e.uid}`);
	return userRef.set(user);
});
```

Deactivate a user account 

```ts
export const deactivateUserAccount = functions.auth.user().onDelete(e => {
	const userRef = db.doc(`users/${e.uid}`);
	return userRef.update({ isInactive: true });
});
```


Time to deploy

```bash
# all fn
firebase deploy --only functions 

# single fn 
firebase deploy --only functions:createUserAccount
```

Delete all users and create again